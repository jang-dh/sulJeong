<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="fundingMapper">
	<sql id="selectSql">
		select code, md_code, title, reward_name, reward_price, goal_price,
		stack_price, image, category, open_date, end_date, funding_state
		from
		funding
		<if test="_paramter != null">
			<where>
				<if test='category!=null and category!="0"'>
					category = #{category}
				</if>
				<if test='where!=null and where.equals("title")'>
					and upper(title) like upper('%' || #{val} || '%')
				</if>
			</where>
			<if test='order!=null and order=="lastest"'>
				order by end_date
			</if>
			<if test='order!=null and order=="newest"'>
				order by open_date desc
			</if>
		</if>
	</sql>

	<select id="select" resultType="funding" parameterType="map">
		<include refid="selectSql" />
		<!-- select code, md_code, title, reward_name, reward_price, goal_price, 
			stack_price, image, category, open_date, end_date, funding_state from funding 
			<where> <if test='category!=null and category!="0"'> category = #{category} 
			</if> <if test='where!=null and where.equals("title")'> and upper(title) 
			like upper('%' || #{val} || '%') </if> </where> <if test='order!=null and 
			order=="lastest"'> order by end_date </if> <if test='order!=null and order=="newest"'> 
			order by open_date desc </if> -->
	</select>

	<select id="selectOrderLikes" resultType="funding"
		parameterType="map">

	</select>

	<select id="selectByMdName" resultType="funding"
		parameterType="map">
		select f.code as code, md_code, title, reward_name,
		reward_price,
		goal_price,
		stack_price, image, category, open_date,
		end_date,
		funding_state
		from funding f, member m
		<where>
			<if test='category!=null and category!="0"'>
				category = #{category}
			</if>
			<if test='where!=null and where.equals("md_name")'>
				md_code = m.code and name like '%' || #{val} || '%'
			</if>
		</where>
		<if test='order!=null and order=="lastest"'>
			order by end_date
		</if>
		<if test='order!=null and order=="newest"'>
			order by open_date desc
		</if>
	</select>
</mapper>