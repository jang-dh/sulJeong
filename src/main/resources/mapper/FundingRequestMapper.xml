<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="fundingRequestMapper">
	<resultMap type="fundingQuestion" id="fundingReqManageDetail">
		<id column="code" property="code" />
		<result column="regdate" property="regdate" />
		<result column="subject" property="subject" />
		<result column="content" property="content" />
		<association property="answer" javaType="fundingAnswer">
			<id column="question_code" property="questionCode" />
			<result column="content" property="content" />
			<result column="regdate" property="regdate" />
		</association>
	</resultMap>

	<!-- 수녕 : 펀딩 신청하기 -->
	<insert id="fundingInsert" parameterType="fundingRequest">
		insert into
		funding_request(CODE,MEMBER_CODE,SUBJECT,FILENAME,STATE,REGDATE)
		values(SEQ_NO.nextval,#{memberCode},#{subject},#{filename},'100',SYSDATE)
	</insert>

	<!-- 수녕 : 내가 만든 펀딩 리스트 -->
	<select id="myFundingOpenList" resultType="funding"
		parameterType="int">
		select code, md_code, title, reward_name, reward_price,
		goal_price, stack_price, image, category, open_date, end_date,
		funding_state
		from funding
		where md_code = #{_parameter}
	</select>

	<!-- 수녕 : 내가 만든 펀딩 detail페이지 - 펀딩 문의 관리 -->
	<select id="myFundingOpenDetail" resultType="fundingQuestion"
		parameterType="int">
		select fq.subject, fq.regdate, fq.state , m.id
		from
		funding_question fq, member m
		where fq.member_code=m.code and
		funding_code=#{_parameter}
	</select>

	<!-- 수녕 : 내가 만든 펀딩 detail페이지 - 참가한 사용자 관리 -->
	<select id="myFundingOpenDetailUserManage" resultType="member"
		parameterType="int">
		select m.id, m.name, m.addr
		from funding f , member m
		where f.md_code=m.code and f.code=#{_parameter}
	</select>







	<!-- 수녕 : 내가 만든 펀딩 detail페이지 - 펀딩 문의 관리 상세페이지 -->
	<select id="myFundingOpenDetailsDetail"
		resultMap="fundingReqManageDetail" parameterType="int">
		select M.id,
		fq.regdate, fq.subject, fq.content, FA.content, FA.regdate
		from
		Funding_Question FQ inner join Funding_Answer FA
		ON FQ.code =
		FA.Question_code
		inner join Member M
		ON FQ.Member_code = M.code
		where
		M.id=#{_parameter}
	</select>

</mapper>	








